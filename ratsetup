-- GUI Setup
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local userInputService = game:GetService("UserInputService")
local runService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local soundService = game:GetService("SoundService")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CustomGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 450, 0, 500)
mainFrame.Position = UDim2.new(0, 300, 0, 100)
mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
mainFrame.BorderColor3 = Color3.fromRGB(124, 53, 255)
mainFrame.BorderSizePixel = 2
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = mainFrame

-- Top Bar (for dragging)
local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1, 0, 0, 40)
topBar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame

local topCorner = Instance.new("UICorner")
topCorner.CornerRadius = UDim.new(0, 8)
topCorner.Parent = topBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 40)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Aratare v1"
titleLabel.TextColor3 = Color3.fromRGB(124, 53, 255)
titleLabel.Font = Enum.Font.Legacy
titleLabel.TextSize = 26
titleLabel.Parent = topBar

-- Dragging
local dragging = false
local dragInput, mousePos, framePos

topBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        mousePos = input.Position
        framePos = mainFrame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

userInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - mousePos
        mainFrame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
    end
end)

-- Sidebar
local sidebar = Instance.new("Frame")
sidebar.Size = UDim2.new(0, 100, 1, 0)
sidebar.Position = UDim2.new(0, 0, 0, 0)
sidebar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
sidebar.BorderSizePixel = 0
sidebar.Parent = mainFrame

-- Section Frames
local combatFrame = Instance.new("Frame")
combatFrame.Size = UDim2.new(1, -100, 1, -40)
combatFrame.Position = UDim2.new(0, 100, 0, 40)
combatFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
combatFrame.BorderSizePixel = 0
combatFrame.Parent = mainFrame

local visualsFrame = combatFrame:Clone()
visualsFrame.Parent = mainFrame
visualsFrame.Visible = false

local miscFrame = combatFrame:Clone()
miscFrame.Parent = mainFrame
miscFrame.Visible = false

-- Tabs
local tabs = {
    {Name = "Combat", Frame = combatFrame},
    {Name = "Visuals", Frame = visualsFrame},
    {Name = "Misc", Frame = miscFrame},
}

for i, tabInfo in ipairs(tabs) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 40)
    btn.Position = UDim2.new(0, 0, 0, 40 * (i-1))
    btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    btn.TextColor3 = Color3.fromRGB(60, 20, 90)
    btn.Font = Enum.Font.Legacy
    btn.TextSize = 18
    btn.Text = tabInfo.Name
    btn.Parent = sidebar

    btn.MouseButton1Click:Connect(function()
        for _, t in ipairs(tabs) do
            t.Frame.Visible = (t == tabInfo)
        end
    end)

    btn.MouseEnter:Connect(function()
        btn.BackgroundColor3 = Color3.fromRGB(124, 53, 255)
    end)

    btn.MouseLeave:Connect(function()
        btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    end)
end

-- Lighting Setup
local OriginalSettings = {
    Brightness = Lighting.Brightness,
    ClockTime = Lighting.ClockTime,
    FogStart = Lighting.FogStart,
    FogEnd = Lighting.FogEnd,
    GlobalShadows = Lighting.GlobalShadows,
    Ambient = Lighting.Ambient,
    OutdoorAmbient = Lighting.OutdoorAmbient,
}

local FullBrightLoop
local NoFogLoop

local function enableFullBright()
    if FullBrightLoop then
        FullBrightLoop:Disconnect()
    end
    Lighting.Brightness = 2
    Lighting.ClockTime = 12
    Lighting.FogEnd = 100000
    Lighting.GlobalShadows = false
    Lighting.Ambient = Color3.fromRGB(255, 255, 255)
    Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)

    FullBrightLoop = runService.RenderStepped:Connect(function()
        Lighting.Brightness = 2
        Lighting.ClockTime = 12
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.Ambient = Color3.fromRGB(255, 255, 255)
        Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
    end)
end

local function disableFullBright()
    if FullBrightLoop then
        FullBrightLoop:Disconnect()
        FullBrightLoop = nil
    end
    for property, value in pairs(OriginalSettings) do
        Lighting[property] = value
    end
end

local function enableNoFog()
    if NoFogLoop then
        NoFogLoop:Disconnect()
    end
    Lighting.FogStart = 1000000
    Lighting.FogEnd = 1000001

    NoFogLoop = runService.RenderStepped:Connect(function()
        Lighting.FogStart = 1000000
        Lighting.FogEnd = 1000001
        local atmosphere = Lighting:FindFirstChildOfClass("Atmosphere")
        if atmosphere then
            atmosphere:Destroy()
        end
    end)
end

local function disableNoFog()
    if NoFogLoop then
        NoFogLoop:Disconnect()
        NoFogLoop = nil
    end
    Lighting.FogStart = OriginalSettings.FogStart
    Lighting.FogEnd = OriginalSettings.FogEnd
end

-- Checkbox Creator
local function createCheckbox(parent, text, pos)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 150, 0, 30)
    btn.Position = pos
    btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    btn.TextColor3 = Color3.fromRGB(200, 200, 255)
    btn.BorderColor3 = Color3.fromRGB(124, 53, 255)
    btn.BorderSizePixel = 1
    btn.Text = text
    btn.Font = Enum.Font.Legacy
    btn.TextSize = 16
    btn.Parent = parent

    local toggled = false

    btn.MouseButton1Click:Connect(function()
        toggled = not toggled
        btn.BackgroundColor3 = toggled and Color3.fromRGB(124, 53, 255) or Color3.fromRGB(0, 0, 0)
    end)

    btn.MouseEnter:Connect(function()
        btn.BackgroundColor3 = toggled and Color3.fromRGB(124, 53, 255) or Color3.fromRGB(60, 20, 90)
    end)

    btn.MouseLeave:Connect(function()
        btn.BackgroundColor3 = toggled and Color3.fromRGB(124, 53, 255) or Color3.fromRGB(0, 0, 0)
    end)

    return btn, function() return toggled end
end

-- Add Checkboxes
createCheckbox(combatFrame, "Hitbox Expander", UDim2.new(0, 20, 0, 20))

createCheckbox(visualsFrame, "Boxes", UDim2.new(0, 20, 0, 20))
createCheckbox(visualsFrame, "Chams", UDim2.new(0, 20, 0, 60))
createCheckbox(visualsFrame, "TC ESP", UDim2.new(0, 20, 0, 100))
createCheckbox(visualsFrame, "Ore ESP", UDim2.new(0, 20, 0, 140))
local fullBrightCheckbox, isFullBrightEnabled = createCheckbox(visualsFrame, "Full Bright", UDim2.new(0, 20, 0, 180))
local noFogCheckbox, isNoFogEnabled = createCheckbox(visualsFrame, "No Fog", UDim2.new(0, 20, 0, 220))

fullBrightCheckbox.MouseButton1Click:Connect(function()
    task.wait()
    if isFullBrightEnabled() then
        enableFullBright()
    else
        disableFullBright()
    end
end)

noFogCheckbox.MouseButton1Click:Connect(function()
    task.wait()
    if isNoFogEnabled() then
        enableNoFog()
    else
        disableNoFog()
    end
end)

createCheckbox(miscFrame, "FOV", UDim2.new(0, 20, 0, 20))

-- FOV Slider
local fovSlider = Instance.new("Frame")
fovSlider.Size = UDim2.new(0, 200, 0, 20)
fovSlider.Position = UDim2.new(0, 20, 0, 60)
fovSlider.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
fovSlider.Parent = miscFrame

local sliderButton = Instance.new("TextButton")
sliderButton.Size = UDim2.new(0, 20, 0, 20)
sliderButton.Position = UDim2.new(0, 0, 0, 0)
sliderButton.BackgroundColor3 = Color3.fromRGB(124, 53, 255)
sliderButton.Text = ""
sliderButton.Parent = fovSlider

local draggingSlider = false

sliderButton.MouseButton1Down:Connect(function()
    draggingSlider = true
end)

userInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = false
    end
end)

userInputService.InputChanged:Connect(function(input)
    if draggingSlider and input.UserInputType == Enum.UserInputType.MouseMovement then
        local sliderPos = math.clamp((input.Position.X - fovSlider.AbsolutePosition.X) / fovSlider.AbsoluteSize.X, 0, 1)
        sliderButton.Position = UDim2.new(sliderPos, -10, 0, 0)
    end
end)

local hitsoundCheckbox, isHitsoundEnabled = createCheckbox(miscFrame, "Hitsound", UDim2.new(0, 20, 0, 100))

hitsoundCheckbox.MouseButton1Click:Connect(function()
    task.wait()
    local headshotSound = soundService:FindFirstChild("PlayerHitHeadshot")
    if headshotSound then
        if isHitsoundEnabled() then
            headshotSound.EqualizerSoundEffect.HighGain = -1.5
            headshotSound.SoundId = "rbxassetid://8726881116"
        else
            headshotSound.EqualizerSoundEffect.HighGain = 0
            headshotSound.SoundId = "rbxassetid://0"
        end
    end
end)

createCheckbox(miscFrame, "Skin Changer", UDim2.new(0, 20, 0, 140))
createCheckbox(miscFrame, "Sky Changer", UDim2.new(0, 20, 0, 180))

-- (ForceField button section could be added next...)
